<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediScan AI - Comprehensive Disease Diagnosis</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>
    <div class="glass-bg"></div>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                    </svg>
                </div>
                <h1>MediScan <span class="accent">AI</span></h1>
            </div>
            <p class="subtitle">Next-Generation Symptom & Pictorial Analysis</p>
        </header>

        <div class="tab-switcher">
            <button class="tab-btn active" data-tab="symptoms">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path
                        d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z" />
                </svg>
                Symptom Analysis
            </button>
            <button class="tab-btn" data-tab="images">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                    <circle cx="8.5" cy="8.5" r="1.5" />
                    <polyline points="21 15 16 10 5 21" />
                </svg>
                Pictorial Diagnosis
            </button>
        </div>

        <main>
            <!-- Symptom Section -->
            <section id="symptomsSection" class="tab-content active">
                <div class="card glass">
                    <div class="card-header">
                        <h2>Describe Your Symptoms</h2>
                        <p>Enter your symptoms separated by commas to get an AI diagnosis.</p>
                    </div>
                    <div class="input-group">
                        <div class="search-box">
                            <input type="text" id="symptomInput"
                                placeholder="e.g. itching, skin rash, nodal skin eruptions...">
                            <button id="symptomSearchBtn" class="primary-btn">Analyze Symptoms</button>
                        </div>
                        <div id="symptomTags" class="tag-container"></div>
                    </div>
                </div>
            </section>

            <!-- Image Section -->
            <section id="imagesSection" class="tab-content">
                <div class="upload-area glass" id="uploadArea">
                    <div class="upload-icon-box">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12" />
                        </svg>
                    </div>
                    <h2>Upload Skin Lesion</h2>
                    <p>Drag & drop image or click to browse</p>
                    <input type="file" id="fileInput" accept="image/*" hidden>
                </div>

                <div class="preview-section card glass" id="previewSection" style="display: none;">
                    <div class="preview-wrapper">
                        <img id="previewImage" alt="Preview">
                        <div class="image-overlay"></div>
                    </div>
                    <button class="analyze-btn" id="analyzeBtn">
                        <span>Start Visual Analysis</span>
                        <div class="loader" style="display: none;"></div>
                    </button>
                    <button class="text-btn" id="cancelUpload">Change Image</button>
                </div>
            </section>

            <!-- Unified Results -->
            <section class="results-container" id="resultsSection" style="display: none;">
                <div class="results-card glass animate-in">
                    <div class="results-nav">
                        <h3>Diagnosis Result</h3>
                        <span class="timestamp" id="resultTimestamp"></span>
                    </div>

                    <div class="result-body">
                        <div class="condition-header">
                            <div class="condition-badge" id="conditionBadge"></div>
                            <h2 id="conditionName"></h2>
                        </div>

                        <div class="stats-grid">
                            <div class="stat-card">
                                <span class="stat-label">AI Confidence</span>
                                <div class="stat-value">
                                    <span id="confidenceValue"></span>
                                    <div class="mini-progress">
                                        <div id="progressFill"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <span class="stat-label">Model Used</span>
                                <span class="stat-value small" id="modelUsed"></span>
                            </div>
                        </div>

                        <div id="matchedSymptomsBox" class="info-box" style="display: none;">
                            <strong>Matched Symptoms:</strong>
                            <div id="matchedSymptomsList" class="mini-tags"></div>
                        </div>

                        <div id="precautionBox" class="info-box" style="display: none;">
                            <strong>Recommended Actions:</strong>
                            <ul id="precautionList"></ul>
                        </div>

                        <div class="warning-box" id="warningBox" style="display: none;">
                            <div class="warning-icon">!</div>
                            <div>
                                <strong>Urgent Clinical Evaluation Recommended</strong>
                                <p>Detected features correlate with high-risk conditions. Consultation with a specialist
                                    is advised immediately.</p>
                            </div>
                        </div>
                    </div>

                    <div class="results-footer">
                        <button class="secondary-btn" id="newAnalysisBtn">New Analysis</button>
                        <button class="primary-btn export-btn" id="downloadPDFBtn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3" />
                            </svg>
                            Download Proper Report
                        </button>
                    </div>
                </div>
            </section>

            <footer class="main-footer">
                <div class="disclaimer glass">
                    <p><strong>Medical Disclaimer:</strong> This system uses artificial intelligence for preliminary
                        analysis based on various datasets. It is NOT a substitute for professional medical diagnosis.
                        Decisions regarding health should always be made in consultation with a qualified medical
                        professional.</p>
                </div>
                <p class="copyright">&copy; 2026 MediScan AI. Advanced Agentic Research Lab.</p>
            </footer>
        </main>
    </div>

    <!-- Hidden Report Template for PDF Export -->
    <!-- Hidden Report Template for PDF Export (Off-screen but with layout) -->
    <div id="pdfReportTemplate"
        style="position: absolute; left: -9999px; width: 800px; padding: 40px; font-family: 'Outfit', sans-serif; background: #ffffff; color: #1e293b; visibility: hidden;">
        <div class="report-header">
            <div
                style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #6366f1; padding-bottom: 1rem; margin-bottom: 2rem;">
                <div>
                    <h1 style="color: #6366f1; margin: 0; font-size: 28pt; font-weight: 800;">MediScan AI</h1>
                    <p style="margin: 0; color: #64748b; font-size: 12pt;">Clinical Intelligence Assessment Report</p>
                </div>
                <div style="text-align: right;">
                    <p style="margin: 0; font-weight: bold; font-size: 10pt; color: #1e293b;" id="pdfDate"></p>
                    <p style="margin: 0; font-size: 9pt; color: #94a3b8;">Ref: MS-AI-2026-REF</p>
                </div>
            </div>
        </div>

        <div class="report-section">
            <h2
                style="color: #0f172a; font-size: 16pt; margin-bottom: 1rem; border-left: 5px solid #6366f1; padding-left: 15px;">
                1. Diagnostic Result</h2>
            <div
                style="background: #f1f5f9; padding: 2rem; border-radius: 12px; margin-bottom: 2rem; border: 1px solid #e2e8f0;">
                <p
                    style="font-size: 9pt; color: #64748b; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.5rem;">
                    Clinical Lead Position:</p>
                <h1 style="color: #1e1b4b; margin: 0; font-size: 24pt; font-weight: 800;" id="pdfCondition"></h1>
                <div
                    style="display: flex; gap: 3rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #cbd5e1;">
                    <div>
                        <p style="font-size: 9pt; color: #64748b; margin: 0;">AI Confidence Level:</p>
                        <p style="font-weight: 800; font-size: 18pt; color: #6366f1; margin: 0;" id="pdfConfidence"></p>
                    </div>
                    <div>
                        <p style="font-size: 9pt; color: #64748b; margin: 0;">Methodology:</p>
                        <p style="font-weight: 800; font-size: 18pt; color: #a855f7; margin: 0;" id="pdfModel"></p>
                    </div>
                </div>
            </div>
        </div>

        <div class="report-section" id="pdfSymptomsSection">
            <h2
                style="color: #0f172a; font-size: 16pt; margin-bottom: 1rem; border-left: 5px solid #6366f1; padding-left: 15px;">
                2. Observed Indicators</h2>
            <div
                style="background: #ffffff; border: 1px solid #e2e8f0; padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem;">
                <p id="pdfSymptoms" style="line-height: 1.6; color: #334155; margin: 0; font-size: 11pt;"></p>
            </div>
        </div>

        <div class="report-section">
            <h2
                style="color: #0f172a; font-size: 16pt; margin-bottom: 1rem; border-left: 5px solid #6366f1; padding-left: 15px;">
                3. Recommended Precautions</h2>
            <div
                style="background: #ffffff; border: 1px solid #e2e8f0; padding: 1rem 1.5rem; border-radius: 12px; margin-bottom: 2rem;">
                <ul id="pdfPrecautions"
                    style="color: #334155; line-height: 2; margin: 0; font-size: 11pt; padding-left: 1.2rem;"></ul>
            </div>
        </div>

        <div id="pdfWarning"
            style="background: #fff1f2; border: 2px solid #ef4444; color: #991b1b; padding: 2rem; border-radius: 12px; margin-bottom: 2rem; display: none;">
            <div style="display: flex; align-items: flex-start; gap: 1rem;">
                <div
                    style="background: #ef4444; color: #ffffff; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; flex-shrink: 0;">
                    !</div>
                <div>
                    <strong style="font-size: 14pt; display: block; margin-bottom: 0.5rem; color: #991b1b;">URGENT
                        MEDICAL EVALUATION ADVISED</strong>
                    <p style="margin: 0; font-size: 10.5pt; line-height: 1.5; color: #991b1b;">This detected condition
                        correlates with pathologies requiring professional dermatological intervention. Please schedule
                        an appointment with a specialist immediately.</p>
                </div>
            </div>
        </div>

        <div class="report-footer"
            style="margin-top: 5rem; padding-top: 1.5rem; border-top: 2px solid #6366f1; font-size: 8.5pt; color: #64748b; line-height: 1.6;">
            <p style="margin-bottom: 0.5rem; color: #1e293b;"><strong>Generated by:</strong> MediScan AI Advanced Vision
                & NLP Systems</p>
            <p style="text-align: justify; opacity: 0.8; color: #64748b;"><strong>Medical Disclaimer:</strong> This
                document is automatically generated by an artificial intelligence model and is intended for
                informational and research purposes only. It does not constitute a clinical diagnosis or medical advice.
                MediScan AI does not guarantee the accuracy of results. Patient health decisions should ALWAYS be based
                on the assessment of a qualified healthcare professional. If you are experiencing a medical emergency,
                please call your local emergency services immediately.</p>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>